import pandas as pd
import networkx as nx
import matplotlib.pyplot as plt

# 从 GML 文件加载图
G = nx.read_gml('reviewers_network.gml')

# 绘制图形并保存
plt.figure(figsize=(12, 12))

# 使用spring_layout或kamada_kawai_layout布局算法进行节点布局
pos = nx.spring_layout(G, seed=42, k=0.9, iterations=100)  # k控制节点之间的距离

# 调整边的宽度和节点大小，边的宽度基于权重，节点大小基于加权度数
edges = G.edges(data=True)
edge_width = [d['weight'] for u, v, d in edges]  # 使用权重来调整边的宽度


# 加权度数计算，节点大小由加权度数决定
weighted_degrees = {'0': 11289, '1': 14955, '2': 45360, '3': 20540, '4': 15907, '5': 14242, '6': 6575, '7': 13848, '8': 17154, '9': 11232, '10': 10855, '11': 14507, '12': 16118, '13': 14423, '14': 29747, '15': 21496, '16': 9701, '17': 10626, '18': 10669, '19': 8274, '20': 11435, '21': 10214, '22': 13368, '23': 16370, '24': 19639, '25': 14115, '26': 9769, '27': 8086, '28': 8677, '29': 11494, '30': 25933, '31': 18830, '32': 16264, '33': 6459, '34': 6661, '35': 27424, '36': 8031, '37': 9046, '38': 8428, '39': 35174, '40': 8660, '41': 6981, '42': 8581, '43': 9605, '44': 9941, '45': 8932, '46': 10228, '47': 14450, '48': 11196, '49': 10978, '50': 13764, '51': 21696, '52': 11830, '53': 10432, '54': 15286, '55': 14796, '56': 15279, '57': 6864, '58': 12917, '59': 8581, '60': 17125, '61': 9650, '62': 16220, '63': 9239, '64': 9086, '65': 6929, '66': 13878, '67': 13687, '68': 19920, '69': 9500, '70': 11474, '71': 8402, '72': 25019, '73': 9108, '74': 11068, '75': 8687, '76': 12719, '77': 7981, '78': 14844, '79': 11637, '80': 17835, '81': 30375, '82': 10542, '83': 16783, '84': 8566, '85': 10160, '86': 23228, '87': 32170, '88': 8127, '89': 11034, '90': 7940, '91': 15185, '92': 24454, '93': 7260, '94': 6834, '95': 9662, '96': 35787, '97': 12045, '98': 10415, '99': 10298, '100': 10741, '101': 32346, '102': 8612, '103': 13425, '104': 7969, '105': 9550, '106': 12173, '107': 12862, '108': 8322, '109': 13259, '110': 13404, '111': 14487, '112': 16466, '113': 14477, '114': 8549, '115': 11294, '116': 15299, '117': 14101, '118': 11146, '119': 22671, '120': 23930, '121': 8940, '122': 16504, '123': 8964, '124': 8939, '125': 11873, '126': 12773, '127': 19648, '128': 11624, '129': 7316, '130': 9832, '131': 9222, '132': 15128, '133': 9607, '134': 12351, '135': 10229, '136': 14807, '137': 8265, '138': 15021, '139': 7432, '140': 8835, '141': 16300, '142': 12758, '143': 12452, '144': 6670, '145': 9200, '146': 10043, '147': 20475, '148': 8665, '149': 11473, '150': 6857, '151': 16264, '152': 10046, '153': 7168, '154': 42502, '155': 9490, '156': 15874, '157': 11897, '158': 10387, '159': 9365, '160': 10739, '161': 36182, '162': 22065, '163': 15068, '164': 13590, '165': 8824, '166': 13862, '167': 17398, '168': 11047, '169': 35930, '170': 11689, '171': 10834, '172': 10364, '173': 8675, '174': 25744, '175': 9545, '176': 8425, '177': 11685, '178': 16188, '179': 37343, '180': 10096, '181': 8064, '182': 12104, '183': 8239, '184': 14616, '185': 27634, '186': 10701, '187': 11304, '188': 8884, '189': 7563, '190': 16442, '191': 11093, '192': 9235, '193': 13322, '194': 13871, '195': 9321, '196': 8732, '197': 13760, '198': 12764, '199': 23162, '200': 8541, '201': 14868, '202': 9325, '203': 17033, '204': 13708, '205': 17638, '206': 11248, '207': 13003, '208': 12643, '209': 11480, '210': 11072, '211': 13161, '212': 13181, '213': 9288, '214': 22109, '215': 20318, '216': 8904, '217': 9215, '218': 8872, '219': 8911, '220': 21259, '221': 13219, '222': 8189, '223': 8388, '224': 18149, '225': 13730, '226': 8176, '227': 8588, '228': 19652, '229': 14824, '230': 14019, '231': 13658, '232': 8617, '233': 9414, '234': 12718, '235': 12698, '236': 34183, '237': 10972, '238': 13419, '239': 15449, '240': 14080, '241': 9295, '242': 13435, '243': 13140, '244': 12183, '245': 13269, '246': 12434, '247': 13447, '248': 8724, '249': 7904, '250': 8514, '251': 16064, '252': 6466, '253': 8451, '254': 10259, '255': 18539, '256': 26423, '257': 9055, '258': 10048, '259': 12832, '260': 8516, '261': 12103, '262': 14439, '263': 10479, '264': 7413, '265': 12354, '266': 11624, '267': 8786, '268': 6883, '269': 18044, '270': 12601, '271': 8296, '272': 9539, '273': 45481, '274': 9452, '275': 16709, '276': 10242, '277': 12133, '278': 7869, '279': 8805, '280': 7882, '281': 7898, '282': 12077, '283': 7221, '284': 8730, '285': 17856, '286': 9771, '287': 8827, '288': 15676, '289': 10312, '290': 9792, '291': 13080, '292': 9471, '293': 9266, '294': 22130, '295': 16376, '296': 14934, '297': 10063, '298': 10321, '299': 15675, '300': 15694, '301': 9099, '302': 13030, '303': 8887, '304': 12566, '305': 9024, '306': 17075, '307': 6698, '308': 17464, '309': 14384, '310': 15170, '311': 20588, '312': 8566, '313': 17340, '314': 8023, '315': 10393, '316': 8035, '317': 17685, '318': 22097, '319': 15314, '320': 8923, '321': 8076, '322': 8976, '323': 37008, '324': 9702, '325': 8839, '326': 8536, '327': 13080, '328': 9219, '329': 12997, '330': 12936, '331': 14770, '332': 14029, '333': 36721, '334': 11448, '335': 9808, '336': 6125, '337': 10292, '338': 16180, '339': 9950, '340': 14459, '341': 11083, '342': 10020, '343': 19114, '344': 16418, '345': 27744, '346': 7199, '347': 19890, '348': 11898, '349': 9387, '350': 7889, '351': 11415, '352': 13598, '353': 7229, '354': 10888, '355': 7885, '356': 10052, '357': 9136, '358': 9014, '359': 6236, '360': 11992, '361': 10199, '362': 10300, '363': 14772, '364': 14777, '365': 8508, '366': 12075, '367': 11502, '368': 9416, '369': 16567, '370': 8241, '371': 22325, '372': 15415, '373': 13295, '374': 8862, '375': 10685, '376': 9446, '377': 11032, '378': 8446, '379': 10385, '380': 7870, '381': 11156, '382': 8773, '383': 9644, '384': 12897, '385': 10330, '386': 11314, '387': 11203, '388': 12329, '389': 18558, '390': 9953, '391': 8188, '392': 9134, '393': 8255, '394': 8032, '395': 18132, '396': 10360, '397': 17358, '398': 13211, '399': 15016, '400': 12923, '401': 10471, '402': 12346, '403': 15691, '404': 8969, '405': 8441, '406': 9216, '407': 40741, '408': 19577, '409': 6495, '410': 6458, '411': 8863, '412': 9868, '413': 26550, '414': 24239, '415': 7524, '416': 22477, '417': 30130, '418': 10319, '419': 9953, '420': 7712, '421': 19122, '422': 18503, '423': 34379, '424': 8748, '425': 25645, '426': 23860, '427': 29842, '428': 10216, '429': 34511, '430': 31359, '431': 13175, '432': 8345, '433': 10296, '434': 13327, '435': 43837, '436': 10528, '437': 32668, '438': 8843, '439': 12405, '440': 8616, '441': 11021, '442': 32988, '443': 13707, '444': 19354, '445': 9888, '446': 9481, '447': 17601, '448': 12420, '449': 7677, '450': 16043, '451': 8513, '452': 36293, '453': 12020, '454': 12068, '455': 12033, '456': 9989, '457': 10584, '458': 10637, '459': 11304, '460': 21407, '461': 16447, '462': 13030, '463': 12455, '464': 45349, '465': 10006, '466': 7179, '467': 30680, '468': 8077, '469': 27349, '470': 20629, '471': 13121, '472': 14570, '473': 13758, '474': 13121, '475': 13121, '476': 13258, '477': 13351, '478': 9937, '479': 12526, '480': 7650, '481': 7638, '482': 16398, '483': 9261, '484': 8862, '485': 7451, '486': 11957, '487': 13880, '488': 20942, '489': 8210, '490': 8112, '491': 8824, '492': 13818, '493': 9654, '494': 11041, '495': 25375, '496': 6787, '497': 6323, '498': 7661, '499': 24131, '500': 9934, '501': 7875, '502': 9747, '503': 12625, '504': 5877, '505': 17231, '506': 8601, '507': 10372, '508': 8506, '509': 15653, '510': 12456, '511': 8932, '512': 10233, '513': 9708, '514': 7732, '515': 8600, '516': 11796, '517': 11126, '518': 8753, '519': 7691, '520': 8343, '521': 9491, '522': 8076, '523': 7438, '524': 10097, '525': 7363, '526': 9710, '527': 9323, '528': 22657, '529': 8678, '530': 9933, '531': 9985, '532': 11037, '533': 6448, '534': 8847, '535': 17568, '536': 9214, '537': 7293, '538': 19416, '539': 9591, '540': 16944, '541': 10074, '542': 12255, '543': 10117, '544': 12363, '545': 8594, '546': 11668, '547': 8129, '548': 8652, '549': 8993, '550': 7717, '551': 8805, '552': 8243, '553': 7062, '554': 8120, '555': 9209, '556': 16213, '557': 12216, '558': 6878, '559': 6610, '560': 14622, '561': 10281, '562': 13587, '563': 7872, '564': 10601, '565': 20572, '566': 7756, '567': 9444, '568': 7883, '569': 9412, '570': 7435, '571': 12163, '572': 6553, '573': 9113, '574': 7014, '575': 22960, '576': 7179, '577': 10630, '578': 9649, '579': 11848, '580': 12860, '581': 11639, '582': 9959, '583': 7994, '584': 9573, '585': 6959, '586': 18078, '587': 7501, '588': 6805, '589': 9265, '590': 12311, '591': 10477, '592': 6913, '593': 9899, '594': 27742, '595': 15819, '596': 17265, '597': 10692, '598': 11829, '599': 8671, '600': 8736, '601': 7511, '602': 8426, '603': 9504, '604': 7643, '605': 13129, '606': 26406, '607': 28174, '608': 17300, '609': 8043, '610': 10816, '611': 10207, '612': 10830, '613': 11307, '614': 8695, '615': 11179, '616': 20860, '617': 12825, '618': 9339, '619': 6663, '620': 16540, '621': 10821, '622': 44009, '623': 9028, '624': 30083, '625': 8520, '626': 9639, '627': 9329, '628': 9835, '629': 6858, '630': 6239, '631': 7327, '632': 10231, '633': 16697, '634': 11893, '635': 10370, '636': 9216, '637': 7380, '638': 10145, '639': 7125, '640': 7227, '641': 9206, '642': 8247, '643': 8153, '644': 7473, '645': 8169, '646': 12386, '647': 8239, '648': 7430, '649': 9977, '650': 15515, '651': 10340, '652': 5965, '653': 8185, '654': 6828, '655': 9702, '656': 9457, '657': 6718, '658': 6172, '659': 8659, '660': 10558, '661': 8432, '662': 9658, '663': 10903, '664': 8595, '665': 8837, '666': 9044, '667': 8887, '668': 7683, '669': 8982, '670': 8599, '671': 7971, '672': 11048, '673': 7298, '674': 8733, '675': 9952, '676': 10461, '677': 8690, '678': 10972, '679': 10735, '680': 12191, '681': 9297, '682': 10199, '683': 7041, '684': 7620, '685': 11434, '686': 11748, '687': 10714, '688': 11325, '689': 9836, '690': 8859, '691': 8564, '692': 7839, '693': 14333, '694': 7702, '695': 30037, '696': 13960, '697': 10619, '698': 11302, '699': 7297, '700': 14491, '701': 13726, '702': 7530, '703': 7482, '704': 28488, '705': 7392, '706': 10205, '707': 14216, '708': 12150, '709': 6526, '710': 9840, '711': 14309, '712': 10610, '713': 15198, '714': 7042, '715': 8401, '716': 9072, '717': 12553, '718': 11710, '719': 8458, '720': 7030, '721': 6684, '722': 7565, '723': 8376, '724': 8805, '725': 15514, '726': 8872, '727': 11293, '728': 8319, '729': 11397, '730': 10994, '731': 12565, '732': 9906, '733': 8524, '734': 7393, '735': 9896, '736': 12949, '737': 7942, '738': 14152, '739': 7561, '740': 7792, '741': 11260, '742': 10834, '743': 7078, '744': 7287, '745': 7572, '746': 8864, '747': 17351, '748': 5898, '749': 39568, '750': 10459, '751': 9016, '752': 8369, '753': 8769, '754': 16380, '755': 6561, '756': 8146, '757': 9193, '758': 7302, '759': 7406, '760': 8714, '761': 8186, '762': 9765, '763': 7451, '764': 6659, '765': 7556, '766': 11703, '767': 8806, '768': 10032, '769': 6564, '770': 7854, '771': 5954, '772': 10184, '773': 10327, '774': 6523, '775': 7989, '776': 16203, '777': 14248, '778': 8361, '779': 7982, '780': 11386, '781': 7605, '782': 7480, '783': 7844, '784': 7605, '785': 9129, '786': 10003, '787': 7404, '788': 9558, '789': 6772, '790': 19596, '791': 7830, '792': 10219, '793': 13403, '794': 5777, '795': 9522, '796': 7850, '797': 11386, '798': 6200, '799': 8188, '800': 9856, '801': 7103, '802': 7447, '803': 10015, '804': 7691, '805': 9814, '806': 8650, '807': 20496, '808': 6988, '809': 7491, '810': 7504, '811': 9995, '812': 14052, '813': 7526, '814': 6256, '815': 7207, '816': 7493, '817': 7991, '818': 8909, '819': 6743, '820': 8140, '821': 7405, '822': 7434, '823': 6200, '824': 7616, '825': 6199, '826': 7019, '827': 9521, '828': 7989, '829': 11230, '830': 7133, '831': 10607, '832': 8451, '833': 7585, '834': 8853, '835': 7097, '836': 7468, '837': 31400, '838': 8498, '839': 5664, '840': 7030, '841': 10090, '842': 6607, '843': 10178, '844': 16351, '845': 8614, '846': 8205, '847': 8417, '848': 6437, '849': 9494, '850': 6921, '851': 8970, '852': 7093, '853': 7372, '854': 8858, '855': 8380, '856': 11568, '857': 9159, '858': 7360, '859': 8816, '860': 7169, '861': 10257, '862': 6921, '863': 6381, '864': 13187, '865': 6708, '866': 5959, '867': 6055, '868': 8957, '869': 8255, '870': 7855, '871': 8979, '872': 7851, '873': 6951, '874': 9498, '875': 9123, '876': 6629, '877': 7740, '878': 7177, '879': 6544, '880': 7272, '881': 7257, '882': 7041, '883': 6132, '884': 7449, '885': 17543, '886': 7172, '887': 7103, '888': 6008, '889': 6854, '890': 6007, '891': 11730, '892': 5052, '893': 6017}
# dict(G.degree(weight='weight'))  # 根据边权重计算度数
# 使用加权度数来调整节点大小，并设置最大值（根据加权度数的平方根或线性关系调整）
max_node_size = 400
node_size = [min(max(weighted_degrees[node] // 1000 * 8 , 10), max_node_size) for node in G.nodes()]  # 节点大小比例

# 绘制图形
# font_weight = 'normal'：常规字体，默认的字体粗细。  'bold'：粗体字。  'light'：细体字。  'ultrabold'：超粗体字。  'ultralight'：超细体字。
nx.draw(G, pos, with_labels=True, node_size=node_size, edge_color=edge_width, width=1.0,
        edge_cmap=plt.cm.Blues, font_size=6, font_weight='bold', node_color='skyblue')

# 绘制边的颜色和宽度
plt.title('影评人评论关系图')

# 保存图形
plt.savefig('reviewers_network.png', format='PNG')
plt.close()
